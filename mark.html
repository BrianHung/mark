<!DOCTYPE html>
<html lang="en">
    <head>
        <title>OneMark</title>
        <meta charset="utf-8">
        <meta name="description" content="A Progressive Note Editor">

        <!-- Add iOS meta tags and icons. -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="default" />
        <link rel="apple-touch-icon" href="./img/OneMark_sm.png">
        <link rel="apple-touch-startup-image" href="/OneMark.png">
        <link rel='shortcut icon' type='image/x-icon' href='./favicon.ico'/>

        <!-- Add links to CSS and preconnects. -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.48.2/lib/codemirror.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.48.2/addon/display/fullscreen.min.css">
        <link rel="stylesheet" href="mark.css">
        <link rel='preconnect' href='https://accounts.google.com' crossorigin="">
    </head>

    <body>
        <div class="cell-container">


        </div>
        <div class="footer">
            <div class="footer-menu float-left">
                <div class="menu-wrap">
                    <div class="menu menu-file" tabindex="-1" style="left: 0;">
                        <h3 class="menu-head">Browse
                            <span class="float-rght"><button class="icon icon-load"></button></span>
                        </h3>
                        <div class="menu-search">
                            <span class="input-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="44" viewBox="0 0 16 44">
                                    <path d="M15.27 28.29l-4.06-4.06a6.113 6.113 0 0 0 1.35-3.83c0-3.39-2.76-6.15-6.15-6.15-3.39 0-6.15 2.76-6.15 6.15s2.76 6.15 6.15 6.15c1.43 0 2.75-.5 3.8-1.33l4.06 4.06 1-.99zM6.4 25.33a4.93 4.93 0 0 1-4.92-4.92c0-2.71 2.2-4.92 4.92-4.92s4.92 2.21 4.92 4.92c.01 2.71-2.2 4.92-4.92 4.92z"/>
                                </svg>
                            </span>
                            <input type="text" class="search-bar" placeholder="Search">
                        </div>
                        <ul class="tree-list">
                        </ul>
                    </div>
                </div>
                <div class="footer-icon">
                    <svg class="icon icon-file" viewBox="0 0 32 32" fill="currentColor" stroke="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" width="32" height="32">
                        <circle r="2.0" cx=" 8" cy="16"></circle>
                        <circle r="2.0" cx="16" cy="16"></circle>
                        <circle r="2.0" cx="24" cy="16"></circle>
                    </svg>
                </div>
            </div>
            <div class="footer-menu float-rght">
                <div class="menu-wrap">
                    <div class="menu menu-help" tabindex="-1">
                        <h3 class="menu-head">Shortcuts</h3>
                        <ul class="menu-list">
                            <li>
                                <span>edit cell</span>
                                <span class="float-rght"><code>enter</code></span>
                            </li>
                            <li>
                                <span>add/render cell</span>
                                <span class="float-rght"><code>shift</code>+<code>enter</code></span>
                            </li>
                            <li>
                                <span>delete cell</span>
                                <span class="float-rght"><code>shift</code>+<code>bkspc</code></span>
                            </li>
                            <li>
                                <span>focus above/below</span>
                                <span class="float-rght"><code>up</code>/<code>down</code></span>
                            </li>
                        </ul>
                        <h3 class="menu-head">Markdown</h3>
                        <ul class="menu-list">
                            <li class="list-line"><hr></li>
                            <li>
                                <span><em>Italics</em></span>
                                <span class="float-rght">_italics_</span>
                            </li>
                            <li>
                                <span><strong>Bold</strong></span>
                                <span class="float-rght">**bold**</span>
                            </li>
                            <li>
                                <span><s>Strikethrough</s></span>
                                <span class="float-rght">~~strike~~</span>
                            </li>
                            <li>
                                <span><mark>Mark</mark></span>
                                <span class="float-rght">==mark==</span>
                            </li>
                            <li>
                                <span><code>Code</code></span>
                                <span class="float-rght">`code`, ```</span>
                            </li>
                            <li>
                                <span><blockquote>quote</blockquote></span>
                                <span class="float-rght">> quote</span>
                            </li>
                            <li>
                                <span>Divider</span>
                                <span class="float-rght">---</span>
                            </li>
                            <li>
                                <span style="font-family: KaTeX_Main; font-size: 15.488px;">
                                    <span style="line-height: 18.6584px;">L</span><span style="font-size: 0.75em; margin: 0px 0px 0px -0.32em; position: relative; top: -0.2em;">A</span><span style="margin: 0px 0px 0px -0.23em; line-height: 18.6584px;">T</span><span style="margin: 0px 0px 0px -0.1667em; line-height: 18.6584px; position: relative; top: 0.2155em;">E</span><span style="margin: 0px 0px 0px -0.125em; line-height: 18.6584px;">X</span>
                                </span>
                                <span class="float-rght">$x^2$, $$</span>
                            </li>
                            <li class="list-line"><hr></li>
                        </ul>
                    </div>
                    <div class="menu menu-main" tabindex="-1">
                        <h3 class="menu-head">Menu</h3>
                        <ul class="menu-list">
                            <li class="list-line"><hr></li>
                            <li>
                                <div class="button-div">
                                    <button class="button" type="button">
                                        <span class="button-icon">
                                            <svg width="25" height="25">
                                                <g fill="none" fill-rule="evenodd">
                                                    <path d="M20.66 12.693c0-.603-.054-1.182-.155-1.738H12.5v3.287h4.575a3.91 3.91 0 0 1-1.697 2.566v2.133h2.747c1.608-1.48 2.535-3.65 2.535-6.24z" fill="#4285F4"></path><path d="M12.5 21c2.295 0 4.22-.76 5.625-2.06l-2.747-2.132c-.76.51-1.734.81-2.878.81-2.214 0-4.088-1.494-4.756-3.503h-2.84v2.202A8.498 8.498 0 0 0 12.5 21z" fill="#34A853"></path><path d="M7.744 14.115c-.17-.51-.267-1.055-.267-1.615s.097-1.105.267-1.615V8.683h-2.84A8.488 8.488 0 0 0 4 12.5c0 1.372.328 2.67.904 3.817l2.84-2.202z" fill="#FBBC05"></path>
                                                    <path d="M12.5 7.38c1.248 0 2.368.43 3.25 1.272l2.437-2.438C16.715 4.842 14.79 4 12.5 4a8.497 8.497 0 0 0-7.596 4.683l2.84 2.202c.668-2.01 2.542-3.504 4.756-3.504z" fill="#EA4335"></path>
                                                </g>
                                            </svg>
                                        </span>
                                        <span class="button-text">Sign in with Google</span>
                                    </button>
                                </div>
                            </li>
                            <li class="list-line"><hr></li>
                            <li><button class="button-hidden" onclick="downloadJson()">Download as JSON    </button></li>
                            <li><button class="button-hidden" onclick="downloadMark()">Download as Markdown</button></li>
                            <li class="list-line"><hr></li>
                            <li><button class="button-hidden" onclick="NightMode()">Toggle Night Mode</button>
                            </li>
                            <li class="list-line"><hr></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-icon" style="right: 0px">
                    <svg class="icon icon-help" viewBox="0 0 32 32"><path d="M4 11c0-1.65 1.29-3 2.867-3h17.266C25.72 8 27 9.344 27 11v10c0 1.652-1.29 3-2.867 3H6.867C5.28 24 4 22.656 4 21V11zm2 10c0 .555.422 1 .942 1h17.116c.51 0 .942-.448.942-1V11c0-.555-.422-1-.942-1H6.942c-.51 0-.942.448-.942 1v10zm2-5.8c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2H8.2c-.11 0-.2-.086-.2-.2v-1.6zm14-3c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2h-1.6c-.11 0-.2-.086-.2-.2v-1.6zm-3 0c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2h-1.6c-.11 0-.2-.086-.2-.2v-1.6zm-3 0c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2h-1.6c-.11 0-.2-.086-.2-.2v-1.6zm-3 0c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2h-1.6c-.11 0-.2-.086-.2-.2v-1.6zm-6 0c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2H7.2c-.11 0-.2-.086-.2-.2v-1.6zm3 0c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2h-1.6c-.11 0-.2-.086-.2-.2v-1.6zm1 3c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2h-1.6c-.11 0-.2-.086-.2-.2v-1.6zm3 0c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2h-1.6c-.11 0-.2-.086-.2-.2v-1.6zm3 0c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2h-1.6c-.11 0-.2-.086-.2-.2v-1.6zm3 0c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2h-1.6c-.11 0-.2-.086-.2-.2v-1.6zm-13 3c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2H7.2c-.11 0-.2-.086-.2-.2v-1.6zm15 0c0-.11.086-.2.2-.2h1.6c.11 0 .2.086.2.2v1.6c0 .11-.086.2-.2.2h-1.6c-.11 0-.2-.086-.2-.2v-1.6zm-12 0c0-.11.095-.2.19-.2h10.62c.105 0 .19.086.19.2v1.6c0 .11-.095.2-.19.2H10.19a.193.193 0 0 1-.19-.2v-1.6z"></path></svg>
                    <svg class="icon icon-main" viewBox="0 0 32 32"><path d="M5 16C5 9.925 9.924 5 16 5c6.075 0 11 4.924 11 11 0 6.075-4.924 11-11 11-6.075 0-11-4.924-11-11zm1.913 0A9.086 9.086 0 0 0 16 25.087 9.086 9.086 0 0 0 25.087 16 9.086 9.086 0 0 0 16 6.913 9.086 9.086 0 0 0 6.913 16zm10.042 5.26h-2.076v-1.874h2.076v1.875zm.656-7.82c0-.83-.563-1.406-1.513-1.406-1.032 0-1.768.616-1.755 2.09h-1.727c-.04-2.09 1.259-3.536 3.495-3.536 2.303 0 3.267 1.299 3.267 2.759 0 1.285-.589 1.955-1.406 2.638l-.763.63c-.375.307-.495.428-.495.896v.603h-1.58v-.857c0-.857.187-1.058.897-1.66l.723-.603c.535-.442.857-.844.857-1.554z" fill-rule="evenodd"></path></svg>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            WebFontConfig = {
                google: { families: [ 'Fira+Mono:400' ] }
            };

            (function() {
                var wf = document.createElement('script');
                wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
                wf.type = 'text/javascript';
                wf.async = 'true';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(wf, s);
            })();
        </script>
        <script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js"></script>

        <script src="https://cdn.jsdelivr.net/npm/codemirror@5.48.2/lib/codemirror.min.js"></script>

        <script src="https://cdn.jsdelivr.net/npm/codemirror@5.48.2/addon/display/fullscreen.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/codemirror@5.48.2/addon/display/placeholder.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/codemirror@5.48.2/addon/mode/overlay.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/codemirror@5.48.2/mode/markdown/markdown.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/codemirror@5.48.2/mode/gfm/gfm.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/codemirror@5.48.2/mode/javascript/javascript.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/codemirror@5.48.2/mode/python/python.js"></script>

        <script src="https://cdn.jsdelivr.net/npm/highlightjs@9.12.0/highlight.pack.min.js"></script>
        <script>hljs.initHighlightingOnLoad()</script>

        <script src="markdown.js"></script>
        <script>const markdown = window.markdown</script>

        <script src="mark.js"></script>
        <script>EventListener(document.body); addCell(document.querySelector(".cell-container"))</script>
        <script src="https://apis.google.com/js/api:client.js?onload=initClient" async defer></script>

        <script>


            // The Client ID obtained from the Google API Console.
            var clientId  = "619548834976-ushntjb1m19qitj99mgbv5hnk3fbpcln"

            var googleAuth
            var googleUser

            var gdrivedocs = "https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"

            var client
            var home_id

            function initClient() {

                gapi.load('client:auth2', function() {
                    // Initialize auth with client settings.
                    gapi.client.init({
                        client_id: `${clientId}.apps.googleusercontent.com`,
                        fetch_basic_profile: true,
                        scope: "https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/drive.appdata",
                        ux_mode: "redirect",
                    }).then(function() {
                        googleAuth = gapi.auth2.getAuthInstance()
                        // Add method to sign in user if not signed in.
                        googleAuth.attachClickHandler(document.querySelector(".button"))
                        // Add method to handle authentication.
                        googleAuth.isSignedIn.listen(handleAuth)
                        // Handle authentication for the initial state.
                        handleAuth(googleAuth.isSignedIn.get())

                    })
                })


                function handleAuth(isSignedIn) {
                    if (isSignedIn) {
                        googleUser = googleAuth.currentUser.get()
                        let authResult = googleUser.getAuthResponse()
                        if (authResult && !authResult.error) {
                            gapi.client.load("drive", "v3", function() {
                                gapi.client.drive.files.list({
                                    q: "name = 'OneMark' and mimeType = 'application/vnd.google-apps.folder'"
                                }).then(function(response) {
                                    var files = response.result.files;
                                    document.temp = files
                                    if (files.length > 0) {
                                        home_id = files[0].id
                                        initDriveToSess(home_id)
                                    } else {
                                        gapi.client.drive.files.create({
                                            resource: {
                                                'name': 'OneMark',
                                                'mimeType': 'application/vnd.google-apps.folder',
                                            },
                                            fields: 'id'
                                        }, function(error, file) {
                                            if (error) {
                                                console.log(error)
                                            } else {
                                                home_id = file.id
                                            }
                                        })
                                    }
                                })
                            })

                        }

                    }
                }



                function getDefault(name='default') {
                    gapi.client.load("drive", "v3", function() {
                        gapi.client.drive.files.list({
                            q: `'${home_id}' in parents and name='${name}'`
                        }).then(function(response) {
                            var files = response.result.files;
                            let tree  = document.querySelector(".tree-list")
                            for(let file of files) {
                                let temp = document.createElement("div")
                                temp.innerHTML = `<li class="tree-item"><button class="button-hidden">${file.name}</button></li>`
                                tree.appendChild(temp.firstChild)
                            }
                        })
                    })
                }


                function listFiles() {
                  gapi.client.drive.files.list({
                    'pageSize': 10,
                    'fields': "nextPageToken, files(id, name)"
                  }).then(function(response) {
                    appendPre('Files:');
                    var files = response.result.files;
                    if (files && files.length > 0) {
                      for (var i = 0; i < files.length; i++) {
                        var file = files[i];
                        appendPre(file.name + ' (' + file.id + ')');
                      }
                    } else {
                      appendPre('No files found.');
                    }
                  });
                }



        }

        function initDriveToSess(folderID) {
            gapi.client.load("drive", "v3", function() {
                let request = gapi.client.drive.files.list({
                    q: `'${folderID}' in parents`
                })
                request.then(function(response) {
                    let files = response.result.files
                    if (files) for (let file of files) {
                        getFileFromDrive(file.id)
                    }
                    initMenuFile(folderID)
                })
            })
        }

        function initMenuFile(folderID) {
            let tree = document.querySelector(".tree-list")
            for(let item of Object.values(sessionStorage)) {
                let file = JSON.parse(item).meta
                if (file.parents.includes(folderID)) {
                    let temp = document.createElement("div")
                    if (file.mimeType != "application/vnd.google-apps.folder") {
                        temp.innerHTML = `<li class="tree-item"><button class="button-hidden" data-id="${file.id}" onclick="getFile(event, this)">${file.name}</button></li>`
                    } else {
                        temp.innerHTML = `<li class="tree-item"><button class="button-hidden" data-id="${file.id}" onclick="getFile(event, this)">${file.name}</button></li>`
                    }
                    tree.appendChild(temp.firstChild)
                }
            }
        }

        function getFileFromDrive(fileId) {
            gapi.client.load("drive", "v3", async function() {
                // Get blob value of the file.
                let request_blob = gapi.client.drive.files.get({
                    fileId: fileId, alt: 'media',
                })
                let blob = await request_blob.then(function(response) {
                    return response.body
                })
                // Get meta value of the file.
                let request_meta = gapi.client.drive.files.get({
                    fileId: fileId, alt: 'json',
                    fields: 'id, name, mimeType, fileExtension, parents',
                })
                let meta = await request_meta.then(function(response) {
                    return JSON.parse(response.body)
                })
                sessionStorage.setItem(fileId, JSON.stringify({blob: blob, meta: meta}))
            })
        }

        function getFile(event, meti) {
            // Remove active from all tree items.
            for(let item of document.querySelectorAll(".tree-item")) {
                item.classList.remove("active")
            }
            // Select active to parent item of button.
            meti.parentElement.classList.add("active")
            // Load file from session onto page.
            getFileFromSess(meti.getAttribute("data-id"))
        }

        const cellContainer = document.querySelector(".cell-container")

        function getFileFromSess(fileId) {
            let file = JSON.parse(sessionStorage.getItem(fileId))
            if (file.meta.fileExtension == "json") {
                initPageFmJson(cellContainer, JSON.parse(file.blob))
            }
        }

        </script>
        <script>
            const iconFile = document.querySelector(".icon-file")
            const iconHelp = document.querySelector(".icon-help")
            const iconMain = document.querySelector(".icon-main")
            const menuFile = document.querySelector(".menu-file")
            const menuHelp = document.querySelector(".menu-help")
            const menuMain = document.querySelector(".menu-main")

            iconFile.addEventListener("click", function(event) {
                menuFile.classList.toggle("active")
                iconFile.classList.toggle("active")
            })
            iconHelp.addEventListener("click", function(event) {
                menuHelp.classList.toggle("active")
                iconHelp.classList.toggle("active")
                menuMain.classList.remove("active")
                iconMain.classList.remove("active")
            })
            iconMain.addEventListener("click", function(event) {
                menuMain.classList.toggle("active")
                iconMain.classList.toggle("active")
                menuHelp.classList.remove("active")
                iconHelp.classList.remove("active")
            })

            const iconLoad = document.querySelector(".icon-load")
            iconLoad.addEventListener("click", function(event) {
                iconLoad.classList.toggle("active")
            })

        </script>
        <script>
            function NightMode() {
                let base, font
                if (document.nightMode) {
                    base = getComputedStyle(document.documentElement).getPropertyValue('--lite-base')
                    font = getComputedStyle(document.documentElement).getPropertyValue('--lite-font')
                } else {
                    base = getComputedStyle(document.documentElement).getPropertyValue('--dark-base')
                    font = getComputedStyle(document.documentElement).getPropertyValue('--dark-font')
                }
                document.documentElement.style.setProperty('--default-base', base)
                document.documentElement.style.setProperty('--default-font', font)
                document.nightMode = !document.nightMode
            }
            var initX, initY, mousePressX, mousePressY;

            cellContainer.addEventListener('mousedown', function(event) {
            	let cell = event.target.closest(".cell")
                if (cell) {
                	let editor = cell.editor
                    let render = cell.render

                    // Prevent vertical scroll while swiping.
                    event.preventDefault()
                    // Get starting x-position for this event.
                    eventX = event.clientX;

                    var offset, color, image, position
                    function reposition(event) {
                        // Get offset from current x-position to initial.
                        offset = Math.min(Math.max(event.clientX - eventX,-200), 200)
                        // Translate editor and render by offset.
                        editor.style.transform = `translateX(${offset + 'px'})`
                        render.style.transform = `translateX(${offset + 'px'})`
                        // Compute background color based on offset.
                        if (offset >   0) { color="rgb( 48, 209,  88)";image="edit"  ;position="02% 50%"}
                        if (offset > 100) { color="rgb( 10, 132, 255)";image="copy"  ;position="02% 50%"}
                        if (offset <   0) { color="rgb(255, 159,  10)";image="add"   ;position="98% 50%"}
                        if (offset <-100) { color="rgb(255,  69,  58)";image="delete";position="98% 50%"}
                        cell.style.backgroundColor = color
                        cell.style.backgroundImage = `url('img/icons/${image}.svg')`
                        cell.style.backgroundPosition = position
                    }

                    cellContainer.addEventListener('mousemove', reposition, false);

                    function action(event, strt=10, half=100) {
                        cellContainer.removeEventListener('mousemove', reposition, false);

                        editor.style.transform = "translateX(0px)"
                        render.style.transform = "translateX(0px)"

                        if ( strt < offset && offset <= half) {
                            cell.editing ? displayRender(cell) : displayEditor(cell)
                        }
                        if ( half < offset) {
                            cellToClipboard(cell)
                        }
                        if (-half < offset && offset <=-strt) {
                            let next = cell.nextElementSibling
                            addCell(cellContainer, next)
                        }
                        if (-half > offset) {
                            cell.parentElement.removeChild(cell)
                        }
                        cellContainer.removeEventListener('mouseup', action, false)
                    }

                    cellContainer.addEventListener('mouseup', action, false);
                }
            }, false);

            cellContainer.addEventListener('touchstart', function(event) {
            	let cell = event.target.closest(".cell")
                if (cell) {
                	let editor = cell.editor
                    let render = cell.render

                    // Prevent vertical scroll while swiping.
                    event.preventDefault()
                    // Get starting x-position for this event.
                    eventX = event.touches[0].clientX;

                    var offset, color, image, position
                    function reposition(event) {
                        // Get offset from current x-position to initial.
                        offset = Math.min(Math.max(event.touches[0].clientX - eventX,-200), 200)
                        // Translate editor and render by offset.
                        editor.style.transform = `translateX(${offset + 'px'})`
                        render.style.transform = `translateX(${offset + 'px'})`
                        // Compute background color based on offset.
                        if (offset >   0) { color="rgb( 48, 209,  88)";image="edit"  ;position="02% 50%"}
                        if (offset > 100) { color="rgb( 10, 132, 255)";image="copy"  ;position="02% 50%"}
                        if (offset <   0) { color="rgb(255, 159,  10)";image="add"   ;position="98% 50%"}
                        if (offset <-100) { color="rgb(255,  69,  58)";image="delete";position="98% 50%"}
                        cell.style.backgroundColor = color
                        cell.style.backgroundImage = `url('img/icons/${image}.svg')`
                        cell.style.backgroundPosition = position
                    }

                    cellContainer.addEventListener('touchmove', reposition, false);

                    function action(event, strt=10, half=100) {
                        cellContainer.removeEventListener('touchmove', reposition, false);

                        editor.style.transform = "translateX(0px)"
                        render.style.transform = "translateX(0px)"

                        if ( strt < offset && offset <= half) {
                            cell.editing ? displayRender(cell) : displayEditor(cell)
                        }
                        if ( half < offset) {
                            cellToClipboard(cell)
                        }
                        if (-half < offset && offset <=-strt) {
                            let next = cell.nextElementSibling
                            addCell(cellContainer, next)
                        }
                        if (-half > offset) {
                            cell.parentElement.removeChild(cell)
                        }
                        cellContainer.removeEventListener('touchend', action, false)
                    }

                    cellContainer.addEventListener('touchend', action, false);
                }
            }, {passive: true});
        </script>
    </body>
</html>
